---
title: "error_noclim"
author: "Sara Orofino"
date: "1/9/2020"
output: html_document
---
#{.tabset}
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

##Data
Need to compare the new error simualtions with no climate change to perfect management and perfect management given FISHE to see what HCRs work.

Read in data:
```{r data, message=FALSE, warning=FALSE}
perfect <- read_csv(file=file.path(here(),"/tests/perfect_management/csv_results/perfect_noclim.csv"))
perfect_fishe <- read_csv(file=file.path(here(),"/Results/error/perfect_fishe_noclim.csv"))
error <- read_csv(file=file.path(here(),"/Results/error/error_noclim.csv"))
```

Want to graph biomass and catch over time for perfect, perfect given FISHE and error at the different HCRs to see which ones work

First let's separate by HCRs:
```{r group-by-hcrs}
#For perfect given FISHE:
hcr2 <- perfect_fishe %>% 
  filter(hcr == 0.80)

hcr25 <- perfect_fishe %>% 
  filter(hcr == 0.75)

hcr3 <- perfect_fishe %>% 
  filter(hcr == 0.70)

#With error:
err2 <- error %>% 
  filter(hcr == 0.80)

err25 <- error %>% 
  filter(hcr == 0.75)

err3 <- error %>% 
  filter(hcr == 0.70)
```

##20% Reduction
First need to get a subset that's easier to graph. Since b0 = 1500 and r = 0.1 is probably the most likely to not do well I'll subset for that.
```{r wrangle-20}
#perfect management:
sub_perf <- perfect %>%
  filter(id == 1)

#perfect with fishe:
sub_fishe <- hcr2 %>%
  filter(id == 1)

#error 0.1:
sub_1 <- err2 %>% 
  filter(id == 1)
  
```


```{r biomass-graphs-20, echo=FALSE, warning=FALSE}

#Biomass over time:
biomass_20 <- ggplot(perfect, aes(x=year, y=b, color = "a")) +
  geom_line() +
  scale_color_manual(name = "", breaks = c("a"), values = c("darkgreen"), labels = c("Perfect Management")) +
  labs(x = "Year", y = "Biomass") +
  theme_bw()

biomass_20

#Catch over time:
catch_20 <- ggplot(perfect_slow, aes(x=year, y=c)) + 
  geom_line(aes(color = "a")) +
  geom_line(data=fishe_slow, aes(x=year, y=c, color = "b")) +
  geom_line(data=error1_slow, aes(x=year, y=c, color = "c")) +
  geom_line(data =error3_slow, aes(x=year, y=c, color = "d")) +
  geom_line(data =error5_slow, aes(x=year, y=c, color = "e")) +  
  scale_color_manual(name = '', breaks = c("a","b", "c", "d", "e"), values = c('darkgreen', 'navy','firebrick4', 'firebrick4', 'firebrick4'),
                     labels = c("Perfect Management", "Perfect with FISHE", "FISHE with 10% Error", "FISHE with 30% Error",
                                "FISHE with 50% Error")) +
  scale_y_continuous(expand = c(0,0), limits = c(100,705), breaks = seq(100,700,100)) +
  scale_x_continuous(expand = c(0,0.5)) + 
  labs(x = "Year", y = "Catch") + 
  theme_bw()

catch_slow

```

